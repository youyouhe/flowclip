# Serena MCP è¯­æ³•æ£€æŸ¥èƒ½åŠ›åˆ†æ

é€šè¿‡å®é™…æµ‹è¯•è¯„ä¼° Serena MCP åœ¨è¯­æ³•é”™è¯¯æ£€æµ‹æ–¹é¢çš„èƒ½åŠ›

## ğŸ§ª æµ‹è¯•ç¯å¢ƒ

åˆ›å»ºäº†åŒ…å« 8 ç§ä¸åŒè¯­æ³•é”™è¯¯çš„æµ‹è¯•æ–‡ä»¶ï¼š
- `test_syntax_errors.py` - åŒ…å«å„ç§ Python è¯­æ³•é”™è¯¯

## ğŸ” Serena è¯­æ³•æ£€æŸ¥èƒ½åŠ›è¯„ä¼°

### âœ… **å¯ä»¥æ£€æµ‹çš„é”™è¯¯ç±»å‹**

#### 1. **é€šè¿‡ `get_symbols_overview` é—´æ¥æ£€æµ‹**
```python
# å½“æ–‡ä»¶æœ‰è¯­æ³•é”™è¯¯æ—¶ï¼Œç¬¦å·è§£æä¼šå¤±è´¥æˆ–åªè§£æéƒ¨åˆ†å†…å®¹
symbols = get_symbols_overview("problematic_file.py")
# ç»“æœï¼šåªè¿”å›åˆ°ç¬¬ä¸€ä¸ªé”™è¯¯ä¹‹å‰çš„ç¬¦å·
```

**æ£€æµ‹æ•ˆæœ**: â­â­â­â˜†â˜† (ä¸­ç­‰)
- èƒ½æ„ŸçŸ¥æ–‡ä»¶æœ‰é—®é¢˜
- æ— æ³•ç²¾ç¡®å®šä½é”™è¯¯ç±»å‹
- è§£æä¼šåœ¨é”™è¯¯å¤„åœæ­¢

### âŒ **æ— æ³•ç›´æ¥æ£€æµ‹çš„é”™è¯¯ç±»å‹**

#### 1. **ç¼ºå°‘å†’å·**
```python
# é”™è¯¯ç¤ºä¾‹
def another_function(param1, param2)  # ç¼ºå°‘å†’å·
    return param1 + param2
```
**Serena çŠ¶æ€**: æ— æ³•ç›´æ¥æ£€æµ‹

#### 2. **ç¼©è¿›é”™è¯¯**
```python
# é”™è¯¯ç¤ºä¾‹
def indentation_error():
    print("correct indentation")
  print("wrong indentation")  # é”™è¯¯ç¼©è¿›
```
**Serena çŠ¶æ€**: æ— æ³•ç›´æ¥æ£€æµ‹

#### 3. **æœªé—­åˆçš„æ‹¬å·/æ‹¬å·/å¤§æ‹¬å·**
```python
# é”™è¯¯ç¤ºä¾‹
def problematic_function(  # æœªé—­åˆçš„åœ†æ‹¬å·
    print("test")
```
**Serena çŠ¶æ€**: æ— æ³•ç›´æ¥æ£€æµ‹

#### 4. **æ— æ•ˆçš„å‡½æ•°å**
```python
# é”™è¯¯ç¤ºä¾‹
def 123invalid_function_name():  # æ•°å­—å¼€å¤´çš„å‡½æ•°å
    pass
```
**Serena çŠ¶æ€**: æ— æ³•ç›´æ¥æ£€æµ‹

## ğŸ› ï¸ **å¯ç”¨çš„é—´æ¥è¯­æ³•æ£€æµ‹æ–¹æ³•**

### æ–¹æ³• 1: ç¬¦å·è§£æå¼‚å¸¸æ£€æµ‹
```python
try:
    symbols = get_symbols_overview("file.py")
    if len(symbols) == 0:
        print("âŒ æ–‡ä»¶å¯èƒ½æœ‰ä¸¥é‡è¯­æ³•é”™è¯¯")
except Exception as e:
    print(f"âŒ è§£æå¤±è´¥ï¼Œå¯èƒ½æ˜¯è¯­æ³•é”™è¯¯: {e}")
```

### æ–¹æ³• 2: æ¨¡å¼æœç´¢æ£€æµ‹å¸¸è§é”™è¯¯
```python
# æœç´¢ç¼ºå°‘å†’å·çš„å‡½æ•°å®šä¹‰
search_for_pattern(
    substring_pattern=r"def\s+\w+\([^)]*\)\s*$",
    restrict_search_to_code_files=True
)

# æœç´¢æœªé—­åˆçš„æ‹¬å·
search_for_pattern(
    substring_pattern=r"\([^)]*$",
    restrict_search_to_code_files=True
)
```

### æ–¹æ³• 3: ç»“åˆç³»ç»Ÿå‘½ä»¤æ£€æµ‹
```python
# ä½¿ç”¨ Python ç¼–è¯‘å™¨è¿›è¡Œç²¾ç¡®æ£€æµ‹
execute_shell_command("python -m py_compile file.py")
```

## ğŸ“Š **å®é™…æµ‹è¯•ç»“æœ**

### æµ‹è¯•æ–‡ä»¶åŒ…å«çš„é”™è¯¯:
1. âŒ æœªé—­åˆçš„åœ†æ‹¬å· - **Serena æ— æ³•ç›´æ¥æ£€æµ‹**
2. âŒ ç¼ºå°‘å†’å· - **Serena æ— æ³•ç›´æ¥æ£€æµ‹** 
3. âœ… æœªé—­åˆçš„å­—ç¬¦ä¸² - **Python ç¼–è¯‘å™¨å¯ä»¥æ£€æµ‹**
4. âŒ é”™è¯¯ç¼©è¿› - **Serena æ— æ³•ç›´æ¥æ£€æµ‹**
5. âŒ æœªé—­åˆçš„å­—å…¸ - **Serona æ— æ³•ç›´æ¥æ£€æµ‹**
6. âŒ é”™è¯¯çš„ import - **Serona æ— æ³•ç›´æ¥æ£€æµ‹**
7. âŒ æ— æ•ˆå‡½æ•°å - **Python ç¼–è¯‘å™¨å¯ä»¥æ£€æµ‹**

## ğŸ¯ **æœ€ä½³å®è·µå»ºè®®**

### 1. **æ··åˆä½¿ç”¨å·¥å…·**
```python
# Step 1: ä½¿ç”¨ Serena è¿›è¡Œåˆæ­¥æ£€æŸ¥
try:
    symbols = get_symbols_overview("file.py")
    print(f"âœ… è§£ææˆåŠŸï¼Œæ‰¾åˆ° {len(symbols)} ä¸ªç¬¦å·")
except Exception as e:
    print(f"âŒ Serena æ£€æµ‹åˆ°é—®é¢˜: {e}")

# Step 2: ä½¿ç”¨ Python ç¼–è¯‘å™¨ç²¾ç¡®æ£€æµ‹
result = execute_shell_command("python -m py_compile file.py")
if result.exit_code != 0:
    print("âŒ Python ç¼–è¯‘å™¨å‘ç°è¯­æ³•é”™è¯¯")
```

### 2. **åˆ›å»ºè¯­æ³•æ£€æŸ¥è¾…åŠ©å‡½æ•°**
```python
def serena_syntax_check(file_path):
    """ä½¿ç”¨ Serena è¿›è¡Œè¯­æ³•æ£€æŸ¥"""
    try:
        # å°è¯•è§£æç¬¦å·
        symbols = get_symbols_overview(file_path)
        
        # æ£€æŸ¥å¸¸è§è¯­æ³•é”™è¯¯æ¨¡å¼
        missing_colon = search_for_pattern(
            substring_pattern=r"def\s+\w+\([^)]*\)\s*$",
            relative_path=file_path
        )
        
        if missing_colon:
            print("âš ï¸  å¯èƒ½ç¼ºå°‘å‡½æ•°å®šä¹‰å†’å·")
            
        return {
            "symbols_found": len(symbols),
            "potential_issues": len(missing_colon),
            "status": "passed"
        }
        
    except Exception as e:
        return {
            "error": str(e),
            "status": "failed"
        }
```

## ğŸ“ **ç»“è®º**

### Serena è¯­æ³•æ£€æŸ¥èƒ½åŠ›æ€»ç»“:

| èƒ½åŠ› | è¯„åˆ† | è¯´æ˜ |
|------|------|------|
| **ç›´æ¥è¯­æ³•æ£€æµ‹** | â­â˜†â˜†â˜†â˜† | ä¸æ”¯æŒ |
| **é—´æ¥é”™è¯¯æ„ŸçŸ¥** | â­â­â­â˜†â˜† | é€šè¿‡ç¬¦å·è§£æå¤±è´¥æ„ŸçŸ¥ |
| **æ¨¡å¼åŒ¹é…æ£€æµ‹** | â­â­â˜†â˜†â˜† | å¯æ£€æµ‹éƒ¨åˆ†å¸¸è§é”™è¯¯ |
| **ä¸ç³»ç»Ÿå·¥å…·ç»“åˆ** | â­â­â­â­â­ | å®Œç¾äº’è¡¥ |

### ğŸ”§ **æ¨èçš„è¯­æ³•æ£€æŸ¥ç­–ç•¥:**

1. **Serena** - ç”¨äºé¡¹ç›®ç»“æ„å’Œç¬¦å·åˆ†æ
2. **Python ç¼–è¯‘å™¨** - ç”¨äºç²¾ç¡®è¯­æ³•é”™è¯¯æ£€æµ‹
3. **è‡ªå®šä¹‰æ¨¡å¼æœç´¢** - ç”¨äºå¸¸è§é”™è¯¯æ¨¡å¼æ£€æµ‹
4. **ä¸“ä¸š Linter** (pylint, flake8) - ç”¨äºä»£ç è´¨é‡æ£€æŸ¥

### ğŸ’¡ **Serena çš„çœŸæ­£ä¼˜åŠ¿:**
- è¯­ä¹‰å±‚é¢çš„ä»£ç åˆ†æ
- æ¶æ„å’Œä¾èµ–å…³ç³»ç†è§£
- ç¬¦å·çº§åˆ«çš„ä»£ç æ“ä½œ
- é¡¹ç›®çŸ¥è¯†åº“æ„å»º

**è¯­æ³•æ£€æŸ¥ä¸æ˜¯ Serena çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œä½†å¯ä»¥é€šè¿‡åˆ›æ„çš„ç»„åˆä½¿ç”¨æ¥å®ç°åŸºç¡€çš„è¯­æ³•æ£€æµ‹èƒ½åŠ›ã€‚**